# Orval usage

This project uses [Orval](https://v5.orval.dev/quick-start) to generate the API client. The orval package is built on top of [ReactQuery](https://tanstack.com/query/v3/docs/react/quick-start).
Address to the ReactQuery [documentation](https://tanstack.com/query/v3/docs/react/guides/queries) to understand how queries are made through Orval.

## Important

Only modify `ward-analytics-api.yml` file!!
The other files are either orval configurations or are auto generated by orval

## Usage

To add a new API call, add the request information to the , under the `files` path.

**Example**

```yml
paths:
  /new/api/endpoint:
    get|post|put|delete:
        # Orval will generate a react hook with the value of operationId in camel notation.
        # I.e., if the operationId is 'get-addresses', the Orval generated hook available on react code will be getAddresses()
        operationId: [REQUEST-TAG]
        description: [REQUEST-DESCRIPTION]
        tags:
            - [REQUEST-TAG]
        # Request parameters (header's and query params)
        parameters:
            - name: [HEADER-PARAMETER-NAME]
            in: header
            description: The api key
            required: true
            schema:
                type: string
            - name: [QUERY-PARAMETER-NAME]
            in: query
            description: The address to analyze
            required: true
            schema:
                type: string
        responses:
            [STATUS-CODE]: # "200", "401", "403", ...
                description: [STATUS-CODE-DESCRIPTION] # "OK" for 200 status code, for example
                content:
                    application/json:
                    schema:
                        $ref: "#/components/schemas/[RESPONSE-DATA]"
        requestBody:
            content:
                application/json: # or application/xml or other content type
                    schema:
                        $ref: "#/components/schemas/[REQUEST-BODY-DATA]"

```

Define the `[RESPONSE-DATA]` and `[REQUEST-BODY-DATA]` entities under the path `components/schemas/`.

When this is ready, simply run `yarn orval --config .\orval.config.cjs` to generate the API client.

**Example**

```yml
components:
  schemas:
    [RESPONSE-DATA]:
    type: object # or array
    properties:
        [PROPERTY-ONE]:
        type: [PROPERTY-ONE-TYPE] # string | number | object | array
        ...
```

Finally, Orval puts the generated files inside folders under the request's tag value.
Tags are located at the bottom of the file and new tags should be added under the path `tags`.
**Example**

```yml
tags:
  - name: [TAG-NAME]
    description: [TAG-DESCRIPTION]
```
